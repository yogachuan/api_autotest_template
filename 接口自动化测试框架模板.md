# 一、fiddler抓包工具

# 二、requests库

说明文档 

# 三、接口中的cookie、token、session

## 3.1 无状态的http协议

以前的web基本都是文档的浏览而已， 既然是浏览，作为服务器，不需要记录在某一段时间里都浏览了什么文档，每次请求都是一个人新的http协议，就是请求加响应。不用记录谁刚刚发出了http请求，每次请求都是全新的。

## 3.2 如何管理会话

​		随着交互式web应用的兴起，如在线网络购物、需要登录的网站等等，就需要将每个人区分开。

## 3.3 标识身份

### session（二代身份证）

​		session从字面讲就是会话。类似你和一个人交谈，你怎么知道对方是张三还是李四，对方肯定有某种特征（外貌）表明他是张三。session类似，服务器要知道当前请求发给自己的是谁。为了做这种区分，服务器要给每个客户端分配不同的“身份标识”，然后客户端每次向服务端发请求时，都带上这个“身份标识”，服务器就知道这个客户端是谁了。对于客户端怎么保存这个“身份标识”，有很多种方式，对于浏览器客户端，大家都采用cookie的方式。

1. 用户向服务器发送用户名和密码
2. 服务器验证通过后，在当前对话（**session**）里面保存相关数据，比如用户角色、登录时间等等
3. 服务器向用户返回一个**session_id**，写入用户的***cookie***
4. 用户随后的每一个请求，都会通过***cookie***，将**session_id**传回服务器
5. 服务端收到**session_id**，找到前期保存的数据，由此得知用户身份

![image-20221128191010356](/Users/yoga/Library/Application Support/typora-user-images/image-20221128191010356.png)

​		一般情况下，若获取了sessionid就可以免登录，那么就会出现安全问题，为了解决这个问题，sessionid是有过期时间的，一般不会太长。

​		其次由于每次发出请求之后，都需要服务器去验证身份，然后在数据库中查询出来该session，如果访问量过大就会造成服务器压力很大。

### token（三代身份证）

​		两者都是为了标识身份的。

1. 用户通过用户名和密码发送请求
2. 程序验证
3. 程序返回一个签名的token给客户端
4. 客户端存储token，并且每次用每次发送请求
5. 服务端验证token并返回数据 

## cookie

​		浏览器和服务器之间的桥梁，session和token都是借助于cookie传递的，但是cookie并不仅仅只能传递session和token，可以根据需求传递其他数据。

***cookie和session的区别:***

1. 存储位置不同，cookie存储在浏览器，session存储在服务器
2. 隐私策略不同：cookie不是很安全，别人可以分析存放在本地的cookie比进行cookie欺骗，考虑到安全应使用session
3. session会在一定时间内保存在服务器上，当访问量增多就会占用服务器性能，考虑到减轻服务器性能方面，用cookie较好
4. 存储大小不同：单个cookie保存的数据不能超过4K，很多浏览器都限制一个站点最多保存20个cookie

一般建议：将登录信息等重要信息存储为session，其他信息若需要保留，可以存放在cookie中

***token和session：***

sesssion是一种http储存机制，为无状态的http提供持久机制；token就是令牌，比如你授权登录一个程序时，它就是个依据，判断你是否已经授权该软件

session和token并不矛盾，作为身份认证token安全性比session好，因为每一个请求都有签名还能防止监听以及重放攻击，而session就必须依据链路层来保障通讯安全了。如上所说，如果你需要实现有状态的回话，仍然可以增加session来在服务端保存一些状态。



 